commonfields:
  id: SilentPush
  version: -1
  type: python
  subtype: python3
  tags: []
  name: SilentPush
  description: Integration with SilentPush API to retrieve domain information and risk scores.
  enabled: true
  author: Your Name
  comments: Integration for fetching domain information, certificates, and more from SilentPush.
  
scripts:
  - id: list-domain-information
    name: List Domain Information
    description: Fetches information about domains, including WHOIS data and risk scores.
    type: python
    args:
      - default: false
        isArray: true
        isRequired: false
        name: domains
        description: Comma-separated list of domains to fetch information for.
    command: |
      list_domain_information_command(client=client, args=args)

  - id: get-domain-certificates
    name: Get Domain Certificates
    description: Fetches SSL/TLS certificates for the specified domain.
    type: python
    args:
      - default: true
        isArray: false
        isRequired: true
        name: domain
        description: The domain to fetch certificate data for.
    command: |
      get_domain_certificates_command(client=client, args=args)

  - id: search-domains
    name: Search Domains
    description: Searches for domains with optional filters like risk score, registration date, etc.
    type: python
    args:
      - default: false
        isArray: false
        isRequired: false
        name: query
        description: Optional search query for domains.
      - default: false
        isArray: false
        isRequired: false
        name: start_date
        description: Optional start date for filtering.
      - default: false
        isArray: false
        isRequired: false
        name: end_date
        description: Optional end date for filtering.
      - default: false
        isArray: false
        isRequired: false
        name: risk_score_min
        description: Minimum risk score filter.
      - default: false
        isArray: false
        isRequired: false
        name: risk_score_max
        description: Maximum risk score filter.
      - default: false
        isArray: false
        isRequired: false
        name: limit
        description: Limit the number of results returned.
    command: |
      search_domains_command(client=client, args=args)

test:
  id: test-module
  name: Test Module
  description: Tests the connectivity to the SilentPush API and verifies the API key.
  type: python
  command: |
    test_module(client=client)

configurations:
  - id: SilentPush_Config
    name: SilentPush Configuration
    description: Configuration for connecting to SilentPush API.
    type: python
    enabled: true
    isArray: false
    isRequired: true
    fields:
      - id: api_key
        name: API Key
        description: API Key for SilentPush.
        isArray: false
        isRequired: true
      - id: base_url
        name: Base URL
        description: The base URL for the SilentPush API.
        isArray: false
        isRequired: true
      - id: verify_ssl
        name: Verify SSL
        description: Whether to verify SSL certificates.
        isArray: false
        isRequired: false
      - id: proxy
        name: Use Proxy
        description: Whether to use a proxy server.
        isArray: false
        isRequired: false

outputs:
  - id: SilentPush.Domain
    contextPath: SilentPush.Domain
    type: array
    description: Domain information and risk scores.
  - id: SilentPush.Certificates
    contextPath: SilentPush.Certificates
    type: array
    description: SSL/TLS certificate data.
